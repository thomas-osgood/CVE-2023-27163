package main

import (
	"net/http"
	"time"
)

// structure representing an object that will be used
// to exploit a vulnerable mailtrail server. this will
// have all the necessary functions attached to it.
type Exploiter struct {
	// base address for the target (including scheme)
	baseurl string

	// malicious basket that gets created by the
	// MakeMaliciousBasket function and used to
	// trigger the remote code execution.
	basketName string

	// http client that will be used to carry out the
	// requests to the target.
	client *http.Client
}

// structure representing the various configuration
// options the user can set while initializing an
// Exploiter object.
type ExploiterOptions struct {
	// base address for the target (including scheme)
	BaseUrl string

	// http client that will be used to carry out the
	// requests to the target.
	Client *http.Client

	// timeout to use when making requests to the
	// target server.
	Timeout time.Duration
}

// structure representing the payload that will be
// transmitted to the target mailtrail server to
// setup the target for the RCE exploit.
type MailtrailPayload struct {
	Capacity      int    `json:"capacity"`
	ExpandPath    bool   `json:"expand_path"`
	ForwardUrl    string `json:"forward_url"`
	Insecure      bool   `json:"insecure"`
	ProxyResponse bool   `json:"proxy_response"`
}
